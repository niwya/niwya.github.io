{"componentChunkName":"component---src-gatsby-theme-portfolio-minimal-templates-article-index-tsx","path":"/projects/cheezam/","result":{"pageContext":{"article":{"banner":{"alt":"Morbier cheese","caption":"","src":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='660'%20height='400'%20viewBox='0%200%20660%20400'%20preserveAspectRatio='none'%3e%3cpath%20d='M0%208l1%207%202%203c1%203%203%203%204-1%201-2%202-2%202-1%200%202%201%202%209%202l9%201h5l-2-1%201-1h5c1%202%202%202%202-1l-1-2h-2l1-3h3l5-2%203-2h1l6-1c5-3%2011-3%2013-1h3c3-3%205-4%208-4h3L41%200H0v8m130-6c0%201%2015%202%2015%200l1-1v2c-1%201-1%201%202%201l10-1%205%201%205-1%201-1%201%201c-1%200%203%203%205%203l1-3V1l2%202c1%203%202%203%202%201%202-4%203-4-25-4-23%200-26%200-25%202m199-1l6%201c0%201%201%202%203%201l6%201h8c1%201%202%201%201%202v1h12l3%201c3%200%204%200%204%202s0%202%202%202c1-1%202%200%203%201%201%202%201%202%204%201h3c1%201%201%201-1%201-3%200-3%201%201%203l2%202%201%201%201-3v-2l2%202%205%202%204%201%203%201%203%203c1%202%202%204%204%204%202%201%202%201%201%202a655%20655%200%200168%203%202063%202063%200%2001146%203c18%201%2023%202%2024%204%200%201-8%201-15-1h-28c-8-1-9-1-11%201s-3%202-22%202a126%20126%200%2001-26-1h-7l1%203c0%203-1%204-3%202v-3c1-2-2-3-6-2l-8%201c-4-1-7%200-7%201h-4c0-2-5-2-6-1h-2c-1-1-1-1-3%201h-2c-2-3-9-3-10-1-2%203-4%202-3-1l-4-1a7455%207455%200%2000-24%200c-1-1-8%201-8%203-1%201-4%200-4-1l3-1c4-1%206-3%205-4l-7%202c-4%201-8%202-19%202h-12l-2%201-2%202-1%201-2-1c0-3-4-4-18-4l-23-1c-3-1-5-1-7%201s-3%202-4%200h-4c-2%202-3%202-4%201h-6l-7-1-11%201-6%202c-2%202-6%201-6-1h-20c0-2-7-1-7%200%200%202-3%205-5%205h-2c-3%201-4%200-2-1%202-3-1-2-4%200-2%202-4%202-2%200s1-3-1-2h-2l-20-1-11%202h-3c-2-1-3-1-6%201h-12l-3%201-4%201c-2%202-4%201-2-1v-2l-13%203h-3l-1%201-1%201-2-1-11%201c-3%202-8%201-7%200l-2-1v2c1%201%201%201-1%201s-2%200-2%202c1%202%200%203-3%202l-1-1%202-2c0-2-1-2-3%200h-3c-2-2-12-1-11%201l-3%203c-3%201-4%203-1%205h8l1-1c2%201%204%200%203-2l1-1%203%202%202%201h3l5%201%2014%201a1719%201719%200%200178-1c2-2%208-2%2015%200%202%201%205%201%205-1%200-1%2021-1%2024%201l7%201%207%201h2c2-2%203-1%203%201-1%201-1%201%201%201h3l1%201%201-2%202-1h2l5%205c1%200%202%200%201-1l4-1h6c1-1%202%200%204%201%201%202%201%202%205%200s13-3%2013-1c1%203%207%205%2012%204h7c5%201%207%201%208-1%201-1%201-1%202%201h11l4%201-1%201-1%201%202%201%201-1%202-1%202%201%204-1h5c2%203%208%206%2013%206l7%201c1%201%201%201%201-1l1-2h1l1%201c1-1%201%200%201%201%200%202%201%203%203%201%201-2%202-1%202%202%200%202%200%202%205%202l4-1c0-2%201-2%204-1l3%203c-1%205%200%206%202%203l2-3c1-1%201-1%202%201h2c0-2%201-2%204-1%206%200%207%201%207%203l2%204%202%202-2%201h1c5%200%208%201%208%202l-2%201h-3v2h2c3%200%204%202%204%208%200%205%200%206%202%207l2%202c-1%201%200%202%201%203%204%203%202%205-4%205-4%200-5%200-4%201l5%201h5l1%203h4c2-2%203-8%201-8v-1l4-1v1l-2%203%202%203v1c-1%200-2%201-2%203l-2%204v2l1%205%202%204h3c2%200%200%202-2%202l-3%202-4%201c-3%200-4%200-4%203%200%202%201%202%205%202%203%200%204%200%204-2s0-2%205%200c3%201%204%204%202%204a142%20142%200%2000-11%201c-4%200-5%200-5%202l-4%201-5%201%202%201%203%201c0%202-2%205-3%203l-2-3c-1-1-1-1-1%202l-1%205c-3%200-7%203-7%205l-4%201c-3%200-4%200-4%202%200%201%203%202%203%200h1l2%201v1c-2%202-6%202-6%201l-9%201-4%201-3%203h-2l-1%201-2-1-4-1c-11%200-14%200-14-2v-1l-5-2c-6-3-9-3-9-1l-4%205-7%205c0%203%200%203-1%202l-2%201c0%202-9%201-13-1l-6-2-1-1-14-3c-2%200-3%201-3%203l-2%202-2%201-3-1c-6-2-9-3-9%200%201%202%201%202-1%202l-3%202-2%203-2%201-1%201-2-1-4-2c-4-2-4-3-4-6l-1-3-6-2c-3-1-5-2-6-1h-21l-12%202-8%201-5%201c-3%200-3%200-2%202%200%203-3%207-6%207-4%200-8%204-5%206%203%200%201%205-2%206a171%20171%200%2000-7%203l-7%203-7%202h-4c-2%201-5%202-8%201l-5%201%2021%202c12%200%2017-1%2024-4l13-3%209-1%202-1%203-2c3-3%2016-8%2027-8%207-1%2013%201%2014%205%200%204%201%205%206%208l6%204c3%203%206%202%2011-2%202-2%204-4%205-3l10-4c4-2%2010-2%2012%200h1l3%201c1%202%203%202%204%202h1c-2%202-2%202%201%202%205%200%207%201%207%203s4%200%204-2c1-2%202-2%205-2h4l3-1h4c1-1%203%200%205%201l5%202%204%202h6l7%201%209%202-1%201c-2%201-1%201%203%201s4%200%204%202%200%203%202%204c4%200%208%200%207-2%200-2%201-1%203%201%203%203%202%209-1%209l-2%201-3%201c-5-2-6%201-2%205l4%203%201%201%201%201%203%201c2%202%205%202%205%200l2-1%201%201c0%202%203%205%204%205l1-1c0-2%200-2%203-1%202%201%203%201%202%202h-1l-3%201c-1%201%200%201%204%201h6l-4%201h-4v4l1%204v1c-1%201-1%201%201%202%201%202%201%202-1%202s-5-3-4-4c0-2%200-2-3%200-3%201-4%206-1%209v14a330%20330%200%2001-3%205v1c-2%201-2%200-2-3v-3l-2%204c-1%204-2%205-4%206l-2%201-2%201c-3%200-7%203-7%204l4-1%203-1%203-1c0-2%203%202%203%204l-4%201-3%201-1%202-2%204-2%204-2%201h-3l-1%201-1%203-3%203c0%201-1%202-3%202-4%200-5%200-5%203-1%202-1%203-4%203-4%201-7%202-4%202l1%201c0%202-7%203-13%203-3%201-4%204%200%204l2%201h-1l-6%202c-3%202-5%202-3%200%201-2%201-2-1-2l-4%201c0%201-1%202-2%201l-1%201%201%201%201%202-5%201-6%201-4%201-4%201-2%202h-3l-2-1-2%202-2%202a518%20518%200%2001-16%202h-1c-3-3-11-3-13%200-2%202-2%202-3%201h-9l-2%201-13%202-3%201c-1%202-9%202-9%201h-2l-15%202-15%201h-19c-17%200-17%200-19%202-3%203-5%204-5%201h-18c-10%200-10%200-12%202l-2%205%201%205%203%205a2004%202004%200%200190%204l182%201h165V0H492L329%201M89%2060l-3%201c-3%200-4%208-1%2010%201%202%206%203%208%201%202-1%202-9%201-11-2-2-5-2-5-1M1%20120c0%2030-1%2028%2011%2024%208-3%2024-5%2024-3l2%201%204%203%202%201%201%201c0%201%207%205%2010%205%204%200%208-2%2011-5%204-4%2013-4%2029-3a726%20726%200%200030%202l-2-5c0-2-5-9-6-10-2%200-5-6-8-15-3-8-6-12-4-7%200%203%200%203-1%202l-2-3h-3l-3-1-3-2c0-2-6-5-6-3l-2%201c-5%200-7%200-8%202l-3%201c-3%200-5%204-4%206l1%201%201%203c1%205%200%205-7%206-14%200-17-1-19-5l-4-4-1-1c0-1-4-2-5-1h-3l-1%202-1%202-1%205c0%207-2%208-8%206-5-2-8-7-10-15l-2-4-1-3c1-1%200-2-1-2l-1-3c1-3%201-3-3-4l-3-1v26m197%2084l1%201%207%206c7%208%2018%2013%2018%208%200-2%201-3%202-3%203-2%202-2-7-7l-7-4c-4-2-13-3-14-1M1%20311v29l19%201a1333%201333%200%2000102%203%208383%208383%200%200092%201c0-1%200-2%202-2s3-1%200-1l-1-4c0-5-3-14-7-16-3-2-5-5-4-10v-5c-1-1-1-1-1%201%200%203-1%205-2%203h-2c-1%200-2%200-1-2%200-2-3-3-5-1h-8l-5-1c-2-1-15-2-21-1h-3c1-2-3-1-4%201-1%201-2%201-4-1h-13l-5-1-2-1h-3c-1-2-5-1-7%200-1%201-3%200-3-2l-4-1c-3%200-5%201-5%202l-9-1-5-1-4-1h-9c-2%202-10%200-10-3h-1l-4-2c-2-2-3-3-4-2h-7c-2-1-2-1-3%201h-2l-2-1c-1%201-4%201-5-1l-3-1-3-1h-3l-1-1-3-2-3-1h-4l-1-2h-2c0%201-1%202-2%201h-4c-2%200-3-1-3-2H2c-1-1-1%208-1%2028'%20fill='%23d3d3d3'%20fill-rule='evenodd'/%3e%3c/svg%3e"},"images":{"fallback":{"src":"/static/da5e7f1db66ba6403cf06e6f860d7735/37a0c/morbier_0.jpg","srcSet":"/static/da5e7f1db66ba6403cf06e6f860d7735/a9008/morbier_0.jpg 150w,\n/static/da5e7f1db66ba6403cf06e6f860d7735/1c084/morbier_0.jpg 300w,\n/static/da5e7f1db66ba6403cf06e6f860d7735/37a0c/morbier_0.jpg 600w","sizes":"(min-width: 600px) 600px, 100vw"},"sources":[{"srcSet":"/static/da5e7f1db66ba6403cf06e6f860d7735/40ac4/morbier_0.webp 150w,\n/static/da5e7f1db66ba6403cf06e6f860d7735/9e761/morbier_0.webp 300w,\n/static/da5e7f1db66ba6403cf06e6f860d7735/2ea1b/morbier_0.webp 600w","type":"image/webp","sizes":"(min-width: 600px) 600px, 100vw"}]},"width":660,"height":400.40000000000003}}}},"body":"<!--**bold**\n    *italics*\n    ## headline\n    ### subheadline\n    #### subsubheadline -->\n<div style=\"text-align: justify\">\n<h2>The main idea</h2>\n<p>    As a French person, I love myself a good cheese board at a restaurant. And from time to time, one cheese out of the selection is just celestial. In that case, I want to know what cheese it is - and to keep its info, to treat myself sometime in the future. I could just ask the restaurant personnel - right? Or, develop my own app so that if I take a picture of a delicious piece of cheese, the app tells me exactly what it is - kind of when you want to know what a piece of music is and you use Shazam.</p>\n<p><em>Note: this was a school project conducted at IIT, but to be honest, I love the idea so much that I will probably improve this project over time and maybe develop an actual app in the future. I'll post any update here!</em></p>\n<hr>\n<h2>The dataset</h2>\n<p>   The dataset is a <u>custom-made</u> dataset from images scraped from Google Images.</p>\n<h3>Scraping the images from Google</h3>\n<p>    The images have been scraped from Google Image with the help of Python module <a href = \"https://github.com/hardikvasa/google-images-download\" target = \"_blank\">google_images_download</a> using queries whose keywords corresponded to the cheeses I wanted to include. In the state of things, the dataset comprises:</p>\n<ul>\n<li><u>Beaufort</u> · 403 images</li>\n<li>Mozzarella · 288 images</li>\n<li><u>Comté</u> · 441 images</li>\n<li>Morbier ·347 images</li>\n<li>Bleu d'Auvergne · 386 images</li>\n</ul>\n<p>   Unfortunately, at the time of this project, Google Images did not allow more than 400 images to be scraped at once - always taken from the top of the Google Images query, so multiple queries under the same keywords yielded identical images.\nNote that Beaufort and Comté are highlighted in the above list - because they're very similar looking cheeses (look it up - by just looking at them, it's hard to tell them apart). In fact, I chose those two because of that characteristic - I wanted to assess my classifier's performance on a dataset with all different cheeses and see if including a cheese that's similar to another changed the metrics.</p>\n<h3>Data augmentation</h3>\n<p>   A few hundreds of images per cheese seemed too few to train a classifier - so I used data augmentation techniques to inflate my dataset. The images were subjected to:</p>\n<ul>\n<li>Random flip</li>\n<li>Random rotations</li>\n<li>Random zoom</li>\n</ul>\n<p>Those operations were performed using TensorFlow Keras' <a href = \"https://www.tensorflow.org/api_docs/python/tf/keras/layers/experimental/preprocessing\" target=\"_blank\">preprocessing functions</a>.</p>\n<hr>\n<h2>Classifier architectures</h2>\n<p>   Multiple classifier architectures were used to train models and confront the results.</p>\n<h3>Base model</h3>\n<p>   The base model has the following architecture:</p>\n<div align=\"center\">\n<table>\n<thead>\n<tr>\n<th align=\"left\"><strong>Layer</strong></th>\n<th align=\"center\">    <strong>Output Shape</strong>    </th>\n<th align=\"right\"><strong>Activation</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"left\">Rescaling</td>\n<td align=\"center\">256·256·3</td>\n<td align=\"right\">·</td>\n</tr>\n<tr>\n<td align=\"left\">Conv2D</td>\n<td align=\"center\">256·256·32</td>\n<td align=\"right\">ReLu</td>\n</tr>\n<tr>\n<td align=\"left\">MaxPooling</td>\n<td align=\"center\">128·128·32</td>\n<td align=\"right\">·</td>\n</tr>\n<tr>\n<td align=\"left\">Conv2D</td>\n<td align=\"center\">128·128·32</td>\n<td align=\"right\">ReLu</td>\n</tr>\n<tr>\n<td align=\"left\">MaxPooling</td>\n<td align=\"center\">64·64·32</td>\n<td align=\"right\">·</td>\n</tr>\n<tr>\n<td align=\"left\">Conv2D</td>\n<td align=\"center\">64·64·32</td>\n<td align=\"right\">ReLu</td>\n</tr>\n<tr>\n<td align=\"left\">MaxPooling</td>\n<td align=\"center\">32·32·32</td>\n<td align=\"right\">·</td>\n</tr>\n<tr>\n<td align=\"left\">Flatten</td>\n<td align=\"center\">32768</td>\n<td align=\"right\">·</td>\n</tr>\n<tr>\n<td align=\"left\">Dense</td>\n<td align=\"center\">128</td>\n<td align=\"right\">ReLu</td>\n</tr>\n<tr>\n<td align=\"left\">Dense</td>\n<td align=\"center\">5</td>\n<td align=\"right\">Softmax</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>   Schematically, all the layers (omitting the rescaling layer) are represented on the following sktech:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c825883daadec3994af8c3d4b6d19c6b/bf6f8/cheezam-baseNetwork.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.66666666666667%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABRNAAAUTQGUyo0vAAAC6ElEQVQozz2SW2hUZxSF9yQxSmPBktbUYKyTTEzMzVxIHCWiDaUgFYTSFxGpVJoYZHKZM2HS0DiOk7mc+c/5z9n7PzPGVJNJQzVRo6QQBW01iibgpVAUEdvHgD4INn20MLskog+LBd/Ltx4W/Cc0D4vuT6dsATFyIE4OzFoJF+vtwHonQOY5DKMNT8wQcPhzyIoAsNAAbl0EjnWBMZEEuHEF2NDcb0TfOmAZ2Pq3+WObTVRkI+V/k/oZ5qwosOjeyMLfwknfxw/kSfjdirombeH6Q4ZzXhv9q9nXChz1Fc2nQ7s+mf3FywmtgWXXWvB3dZcMp1PbbNvejIgVDuJ6g9TWO9aQ+6k8vmfaTrZEKPVRBk3ggQ0uFj0NLHqqWPrWsN7bHB2XZV+dO7NvwRhq1h21Dto7j9WPjY+XSNMsIMRNiLhDIW5OkqqNUKpekHI7iGWI6LGIyu/Lk95RlI13zVgJ+2vy8jqmcqelrJ+3IofSaLshPhStSKecihiqVSapCkJstYhyCbHRQWwOUTrXIFVJiF5ErNRJ7R6R6B48TW3fTo7uwNNnPhPxhOdPK7xv2k6WQu/5TFPatBoUYfEoyhpE+gIR3fR20a4RtEonbLPKRtpOiFuQsC2Kw0VHUmlv5NrMd2NXp78+cW+u7Lk+UHsOzTqIy3ihIuV5JMPVS0awbhjt0iSpfJMo30H0vDL6y5eMYHmSVLGNtHYEreLHMtTyQg56Z4PBwsu3f93p3J87sBjr6xxTdh3MnNKBuwBY9Nay0BpZ/77gmTwOT2UIOLI3j4XWxELbwkP7c1dY/OAqFr3LrIV/+DK//tLN1aZS2x7JcNMCRgEu/4TQrCaB9aPASR9ct2I5kPkLfrNisD19YVkE/xrBnIcynDPh6MAB9wpj0QPziUFQUn74xAy1suH/4KU5AMCZCLDZB1mhvQ+/S+LwSi+fOWtokD17ELKnOiBr+l1ZEXBx+AhsXPwH2AhUs9CKlyX/A5oye6iCuGraAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"&quot;Base model architecture&quot;\"\n        title=\"Figure - Base network architecture\"\n        src=\"/static/c825883daadec3994af8c3d4b6d19c6b/c1b63/cheezam-baseNetwork.png\"\n        srcset=\"/static/c825883daadec3994af8c3d4b6d19c6b/5a46d/cheezam-baseNetwork.png 300w,\n/static/c825883daadec3994af8c3d4b6d19c6b/0a47e/cheezam-baseNetwork.png 600w,\n/static/c825883daadec3994af8c3d4b6d19c6b/c1b63/cheezam-baseNetwork.png 1200w,\n/static/c825883daadec3994af8c3d4b6d19c6b/d61c2/cheezam-baseNetwork.png 1800w,\n/static/c825883daadec3994af8c3d4b6d19c6b/bf6f8/cheezam-baseNetwork.png 2047w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>   The rescaling layer is only there because the initial images are RGB images with different sizes - but they all need to be the same shape (256·256·3) once fed as input to the classifier.</p>\n<h3>Base model with dropout</h3>\n<p>   The base model is used, but with a few tweaks. Dropout layers are added after the second and third convolutional layers. These dropout layers randomly set inputs to 0 <u>with a frequency of 0.4</u> (during training only). This helps avoiding the overfitting of our model - <em>i.e.</em> it prevents the model from picking up too many details from the training data that may not be generalizable.</p>\n<h3>Base model with dropout and data augmentation</h3>\n<p>   Here once again, the base model is incremented with three new layers: <u>RandomFlip</u>, <u>RandomRotation</u> and <u>RandomZoom</u> , with parameters <u>'horizontal'</u>, <u>0.1</u> and <u>0.1</u> respectfully. Those layers are placed right after the resizing layer, and before the first convolution. This layer will provide artificial new images, by messing a bit with the images from the initial dataset. This way, the network is more robust to changes in size or in orientation of the cheeses. The operations performed can be visualized on the figure below - the rotate and zoom operations have been exaggerated for convenience:\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 1200px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2e58eef92e540ec9609ea46850cef878/71c1d/cheezam-dataAugmentation.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 85.33333333333334%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAABRNAAAUTQGUyo0vAAAEDUlEQVQ4y41Ua0zbVRQ/XWkplIcTaHmUtoQQRGEzIW6JWbJPakyWLNFFsmTMLH5QEV3be0uLaQDHY/333tKO12SACyvQDlwwYniULdsUzTCZzmiyJTqNAdTpjNMopEDvMbeAivODJzm5N/ec87vnDfAvEoxssVYwki8YMQlOCwWjJsGIRTCSsaXzv0gwoto0MCEjOb91NSThiZc16LUlI6fGdU6t2FwDdwMuFUQjALMRSJz3kXyMngdkRIWKHdY5tay11+mxtbYgFnA/fK+nKWVZsSehYjcpgxxWOd0A/CdvB9vgswMnVR/2NAL6HBb0HEv9pafp6O1Q4PivnR4jOqo0759uKoNrUzsBcctmO/Bfl9nzG+fncyCVP+luKEfXEe3ViUH9FyMdKXfPtAByp+5OwG2FG1dSNTPhSohG0u4DTeRg9u8fMqaHs2FuomC+u+EhVOw5eKhSha4jmu86PclrnGYjI5amUDtkTQ1lQjSyB6KRjO0ezm7LQ9qOaMSwb7wf0FWtRp/DtBSsL5nqPfEottSa0ecoQUYy8UA5wOULsAlm/e+QoxEjRCNPwMVRFcxPAwLAte5GgPjvapibMACuqWUqsO1VwKfLAC6NbYVpgGgkCS6OQur0CECovw0AY5A0E67UzYQtz4ydVqNig46zPpUE2Dk1bNbNhPenzIzsTZ8e3rV/vE8DizehS8pvfSxBjHmToVT44Ssofm8QoOWcP1EE+ODd3JpwB6z4nbLCsn0AvTYY7WsFuPqOCX78Oun7oBtkDyZ03EeharQH4Mp4Pnw0mcEGGcD1SwDYWqv99lR9Ud9b3sdQsVti3FmEjBQJRnJWOc1HxW6O9LdVLATri9FnLxac5AlGsuJS5nPk3Or0mO8E6wuRkdJlv3MHxDktlILnJocg7/plQE41gpE0wcjjgjsfQPshNdLDOuRUHeNUjt0jmyNZsdZe9xT6nWXY9KJBMFIiGNHJ0ArXOU3/ubuxDH32Pei16WRYgtNKbK1Nu9fTWLoSdB9Ed7V2MRRQISNWwWkxMlKHnmPl2PZa9XLH61xwWoo+R7L00IxvvJR5OxR4cmnA68GTxw0LA175XoEtrxgWzvp2fzkUtK22u3Z9NvYmxLkz0T5xv9N14+3e1pH56PM3w10EFdvuWMCdLD2xos+R/keHBz69cCZVzjEqdrkgyuJ+p/Wn3mZYGvBqsWovYMMLqjinBajY8mMB94FvzvldiwPefdhcIz/JjXOqh8RK4jQ/zp0p2Fyjx438ZUtAZKQkFnDrUbGlo2LXC06NMkWC0yJU7NloezYLaw/qVk7VpwhOy5ERrQSURchN7DxOLZs7T1ZZLxh5UGwAmAWTTIoFo5nSUHBqWg248uLcubkviTHOnfAnSo5b42UHgjkAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"&quot;Data augmentation operations&quot;\"\n        title=\"Figure - Data augmentation operations\"\n        src=\"/static/2e58eef92e540ec9609ea46850cef878/c1b63/cheezam-dataAugmentation.png\"\n        srcset=\"/static/2e58eef92e540ec9609ea46850cef878/5a46d/cheezam-dataAugmentation.png 300w,\n/static/2e58eef92e540ec9609ea46850cef878/0a47e/cheezam-dataAugmentation.png 600w,\n/static/2e58eef92e540ec9609ea46850cef878/c1b63/cheezam-dataAugmentation.png 1200w,\n/static/2e58eef92e540ec9609ea46850cef878/71c1d/cheezam-dataAugmentation.png 1536w\"\n        sizes=\"(max-width: 1200px) 100vw, 1200px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3>VGG-16 with dropout and data augmentation</h3>\n<p>   VGG-16 - with VGG standing for <em>Visual Geometry Group</em> - is a 16 layers deep convolutional neural network architecture. It was developed by K. Simonyan and A. Zisserman from the eponymous Visual Geometry Group of the University of Oxford, UK. This architecture, along with the VGG-19, scored very high in the localization and classification of the ILSVRC-2014, so that's why I chose it - more details on <a href = \"https://www.robots.ox.ac.uk/~vgg/research/very_deep/\" target = \"_blank\">this conference paper</a>. There's actually a lot of VGG-16 pre-trained implementations in different languages, but I decided to break it down and code it myself, since I did this projects to learn more about convolutional neural networks.</p>\n<hr>\n<h2>Classification results</h2>\n<p>   The following graph shows the validation accuracies for the base model, its incrementation with dropout layers and its version with dropout and data augmentation. It is clear that the model using dropout layers and data augmentation technoiques performs better that the other two, after 40 training epochs. In fact, with very little time spent tuning the model, it reaches a validation accuracy of about 70% on a dataset with two quasi-identical cheeses.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 432px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/ef1425fa33f9fc68c84d89e335b0d0ca/0e0c3/cheezam-cnn4.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 66.66666666666666%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAACtUlEQVQ4y6WTzW7bRhDHN3XbpIceit6j9FFy7QM1BZo6aZvkDfoCTpTAb9CDesjBFwkGaIulGX6ZVEiK+qIkrrlccj/+xbKqnUtPHWCwg92ZH/47s0sAkK7ryNnZGTExIeRrQshXhJDPCSFfEELuE0KOCCFfEkIeHOKjQ445e2Dq3v/5noz+GJF/Ifcmk8n3eZ6/tm373dXV1Vvf919/8D68cV13GEfxieM6b0IvHHq+d2JdWSeO47yzbGs4mU7eztLZ747tfOM6bg88MtCiKH7Gf1gtaxRNAa45dt0OZVti05b9WskKlFGkcfpdlmQ98J4Bep73kylWSrVKaam0kkopWfFKLuul3PG9LG6Kfg+AlEqYVZgSznnrB8HDMAzvFGZZ9kRrbZgmUWutEO+vkdH0oFPfKpZKgbUSO9bpLeuwp7VMZ/EgmyU98DMDDILgqUnupJTFjuu43CCt9ihZi30jUXHVw5a0RbhmoK2G6LpeAmu4jMJgcB19qjDPfzAF+0bKgnLtFil25QbbRYp1WfaeL9coNltU+y3QVsA20WAlmprKMJ4NoiS9U3gdBU+5UFhtNrJc2ZqXEdBRQDZAvYLmFPKmBJoS2MXQ2xm0khpaobmpZJikgyj5eAfMsvRJ1WjQxV+yXvtatS1aqSCE/KR7gPpnIpBSQCptDDVrZBgEg+hw5R4YRvGPdJtjW33kTAhBay7i+FokSSIopYI3jWCMia5txWG6xjvDbxrW2rb90HGcux7m88UzVoZoOwrzMhhbIAh8RFEE13XheR6m0ynm8znW6zVWqxUWiwWWy2Xv8/n8UVEUtz+FjEajx/PZ7FWRF8dpmh47nvfC9/3nFxcXL8MwPLYs65Xnec+m0+nLy8vL5+Px+MX5+fkvlmX9Oh6PfxsOh9+enp6SWzPg/+Pm+xrQ3xQAP1rtjMlwAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"&quot;Testing accuracies&quot;\"\n        title=\"Figure - Validation accuracies\"\n        src=\"/static/ef1425fa33f9fc68c84d89e335b0d0ca/0e0c3/cheezam-cnn4.png\"\n        srcset=\"/static/ef1425fa33f9fc68c84d89e335b0d0ca/5a46d/cheezam-cnn4.png 300w,\n/static/ef1425fa33f9fc68c84d89e335b0d0ca/0e0c3/cheezam-cnn4.png 432w\"\n        sizes=\"(max-width: 432px) 100vw, 432px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<p>   I purposely chose not to include the VGG-16 results in this articles, as the current tuning of the model as can be seen on GitHub is not ideal. In fact, it barely reaches 60% validation accuracy on the state of things (though it reached above 80% when I submitted my project for grading) as I kept messing with the activation functions, dropout layers, batch normalization layers and so on and lost my working local copy. Stay tuned on GitHub for more recent updates!</p>\n<hr>\n<h2>Future work</h2>\n<h3>More cheeses</h3>\n<p>   The idea is to be able to classify most cheeses from pictures - and there are a LOT of them. But this requires me to build a more complete dataset, and in the state of things, will be difficult. Not only the number of images I can get from Google Images is limited to a few hundreds per cheese type, but some cheeses may be underdocumented. Also, the neural network will need to be tweaked a little to accomodate the higher number of labels.</p>\n<h3>An app?</h3>\n<p>   The end goal for this project is to build an actual application to be used on phones, to classify cheeses on the fly (<em>i.e</em> when you are at a restaurant and want to know what kind of cheese is in your platter). This is 100% doable, but an issue to keep in mind is that <u>cheeses on cheese platters are often cut in small slices</u> - which means I probaly should use a dataset of sliced cheeses to train my classifier. However, this might be more challenging than classifying whole cheeses or bigger slices. In the end, all hinges on choosing the proper way to build the dataset.</p>\n<hr>\n<p>Find this project on <a href = \"https://github.com/niwya/cheezam\">GitHub</a>.</p>\n</div>","categories":["Machine Learning","Python"],"date":"April 26, 2021","description":"A cheese classifier.","id":"c18de7be-f57d-5995-b354-9e95d83204e0","keywords":["Classifier","Cheeze","Image Scraping","Data Augmentation","Python","VGG-16"],"slug":"/projects/cheezam/","title":"Cheezam","readingTime":{"text":"7 min read"}},"listingPagePath":"/projects"}},"staticQueryHashes":["1094019748","36698639"]}